<template name="sgiCollectionField">
    <div>
        <sgi-field-group class="sgi-collection-field" name="[[field.label]]">
            <div ng-model="collection" sgi-max-count="{{validation.maxCount.value}}" sgi-min-count="{{validation.minCount.value}}" >
            <div class="sgi-collection-add-button">
                <button ng-click="addModel(collection, $event)">+</button>
            </div>
            <div ng-show="hasAvailableCollection(collection)" class="sgi-collection-selection-list">
                <div class="collection-selection-row" ng-repeat="item in collection">
                    <div ng-class="{selected: isSelectedRow($index), invalid: isInvalidRow($index)}" ng-click="switchModel($index, $event)">[[this.getDisplayString(item)]]</div>
                </div>
            </div>
    </div>
    <hr>
    <div class="sgi-new-model">
        <div ng-show="myIndex != null">
            <sgi-autoform class="sgi-collection-field-new-model" field="{{id}}" unwrapped="true"></sgi-autoform>
        </div>

        <div ng-show="myIndex == null">Click an item in the list above to edit</div>
    </div>
    <div class="error" ng-if="field.validation.minCount.value"><span class="error" ng-show="{{formName}}.{{fieldId}}.$dirty && {{formName}}.{{fieldId}}.$error.minCount">[[field.validation.minCount.message || 'Too few!']]</span></div>
    <div class="error" ng-if="field.validation.maxCount.value"><span class="error" ng-show="{{formName}}.{{fieldId}}.$dirty && {{formName}}.{{fieldId}}.$error.maxCount">[[field.validation.maxCount.message || 'Too many!']]</span></div>

    </sgi-field-group>
    </div>
</template>